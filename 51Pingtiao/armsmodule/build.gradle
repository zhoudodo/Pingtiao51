apply plugin: 'com.android.application'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-android-extensions'
apply plugin: 'kotlin-kapt'                //æ·»åŠ kotlin-kaptä¿è¯draggerXXXComponentçš„æ­£å¸¸ç”Ÿæˆ
apply plugin: 'walle'
android {
    compileSdkVersion rootProject.ext.android["compileSdkVersion"]

    useLibrary 'org.apache.http.legacy'

    compileOptions {
        targetCompatibility JavaVersion.VERSION_1_8
        sourceCompatibility JavaVersion.VERSION_1_8
    }

    defaultConfig {
        applicationId "com.receipt.px"
        minSdkVersion rootProject.ext.android["minSdkVersion"]
        targetSdkVersion rootProject.ext.android["targetSdkVersion"]
        versionCode rootProject.ext.android["versionCode"]
        versionName rootProject.ext.android["versionName"]
        testInstrumentationRunner rootProject.ext.dependencies["androidJUnitRunner"]
        flavorDimensions "versionCode"
        multiDexEnabled true
        dexOptions {
            javaMaxHeapSize "4g"
            jumboMode = true
            preDexLibraries = false
            additionalParameters = [
                    '--multi-dex',//å¤šåˆ†åŒ…
                    '--set-max-idx-number=60000'//æ¯ä¸ªåŒ…å†…æ–¹æ³•æ•°ä¸Šé™
            ]
        }

//            ndk {
//                //é€‰æ‹©è¦æ·»åŠ çš„å¯¹åº” cpu ç±»å‹çš„ .so åº“ã€‚
//                abiFilters 'armeabi', 'armeabi-v7a', 'arm64-v8a'
//                // è¿˜å¯ä»¥æ·»åŠ  'x86', 'x86_64', 'mips', 'mips64'
//            }

            manifestPlaceholders = [
                    JPUSH_PKGNAME : applicationId,
                    JPUSH_APPKEY : "2f01a6d549fdc3c3431cca7e", //JPush ä¸Šæ³¨å†Œçš„åŒ…åå¯¹åº”çš„ Appkey.
                    JPUSH_CHANNEL : "developer-default", //æš‚æ—¶å¡«å†™é»˜è®¤å€¼å³å¯.
            ]
    }

    //ç­¾å
    signingConfigs {
        release {
            storeFile file("pingtiao51.jks")
            storePassword 'pingtiao51'
            keyAlias 'pingtiao51'
            keyPassword 'pingtiao51'
        }

        debug {
            storeFile file("pingtiao51.jks")
            storePassword 'pingtiao51'
            keyAlias 'pingtiao51'
            keyPassword 'pingtiao51'
        }
    }
    buildTypes {
        debug {
            //versionNameè‡ªå®šä¹‰åç¼€
//            versionNameSuffix "-debug"

            buildConfigField "boolean", "LOG_DEBUG", "true"
            buildConfigField "boolean", "USE_CANARY", "true"
            minifyEnabled false
            signingConfig signingConfigs.debug
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro' ,'-dontwarn com.zhy.autolayout.*'

            buildConfigField "String", "TRACK_BASE_URL", "\"http://192.168.3.57:8080/\""
//            buildConfigField "String", "BASE_URL", "\"http://192.168.3.55:8001/\""


//            buildConfigField "String", "BASE_URL", "\"http://api.51pingtiao.com/\""
//            buildConfigField "String", "BASE_H5_URL", "\"http://pt.51pingtiao.com/#/\""
//            buildConfigField "String", "BASE_H5_URL", "\"http://app.51pingtiao.com/#/\""
            buildConfigField "String", "BASE_URL", "\"http://115.236.176.90:8001/\""
            buildConfigField "String", "BASE_H5_URL", "\"http://testapp.51pingtiao.com/#/\""
//            buildConfigField "String", "MOXIE_API_KEY", "\"9dab09bbd44f4730a82b9a7f1543519f\""
        }

        release {
            buildConfigField "boolean", "LOG_DEBUG", "false"
            buildConfigField "boolean", "USE_CANARY", "false"
            minifyEnabled false
//            shrinkResources true
//            zipAlignEnabled true
            signingConfig signingConfigs.release
//            multiDexKeepProguard file('multidex-config.pro')
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'

//            buildConfigField "String", "TRACK_BASE_URL", "\"https://data.qulicai8.com/\""
//            buildConfigField "String", "BASE_H5_URL", "\"http://pt.51pingtiao.com/#/\""
            buildConfigField "String", "BASE_URL", "\"http://api.51pingtiao.com/\""
            buildConfigField "String", "BASE_H5_URL", "\"http://app.51pingtiao.com/#/\""
//            buildConfigField "String", "MOXIE_API_KEY", "\"462efea018e746179eb81789e22d694d\""
//            buildConfigField "String", "MOXIE_API_KEY", "\"9dab09bbd44f4730a82b9a7f1543519f\""
           /* buildConfigField "String", "BASE_URL", "\"http://115.236.176.90:8001/\""
            buildConfigField "String", "BASE_H5_URL", "\"http://testapp.51pingtiao.com/#/\""*/
        }

    }


    lintOptions {
        disable 'InvalidPackage'
        disable "ResourceType"
        abortOnError false
    }
    productFlavors {
        // ä¸åŒé©¬ç”²åŒ…çš„é…ç½®ä¿¡æ¯
        ishou {
            resValue "string", "app_name", "çˆ±æ”¶"
            applicationId 'com.ishou'
            manifestPlaceholders = [
                    package_name       : applicationId,
                    UMENG_CHANNEL_VALUE: "offline",
                    UMENG_APPKEY       : "5bbda940b465f5619b0001d9",
                    JPUSH_PKGNAME      : applicationId,
                    JPUSH_APPKEY       : "a17b2215fc2192222cc4cc2d",
                    JPUSH_CHANNEL      : "developer-default",
            ]
            buildConfigField "String", "UMENG_PUSH_SECRET", "\"fe19dfe94c4042d65ebaa72d718847ac\""
            buildConfigField "String", "ANDROID_BANNER_NID", "\"androidHomeBannerHuiShou2\""
            buildConfigField "Integer", "APP_ID", "4"
            buildConfigField "String", "APP_FLAG", "\"ISHOU\""
            buildConfigField "String", "APP_NAME", "\"çˆ±æ”¶\""
            buildConfigField "String", "QIYU_APPKEY", "\"5d68d29bb8d235e4b0dde6edac7e32d1\""
        }

        xinyi {
            resValue "string", "app_name", "ä¿¡ä¹‰è´·"
            applicationId 'com.xinyi'
            manifestPlaceholders = [
                    package_name       : applicationId,
                    UMENG_CHANNEL_VALUE: "offline",
                    UMENG_APPKEY       : "5bd66c8cb465f56d7600001c",
                    JPUSH_PKGNAME      : applicationId,
                    JPUSH_APPKEY       : "8f72ddd3680fc02b28811d16",
                    JPUSH_CHANNEL      : "developer-default",
            ]
            buildConfigField "String", "UMENG_PUSH_SECRET", "\"1475d1586bd9c83606049ef0db4f2e4a\""
            buildConfigField "String", "ANDROID_BANNER_NID", "\"androidHomeBannerXinYi\""
            buildConfigField "Integer", "APP_ID", "101"
            buildConfigField "String", "APP_FLAG", "\"XINYI\""
            buildConfigField "String", "APP_NAME", "\"ä¿¡ä¹‰è´·\""
            buildConfigField "String", "QIYU_APPKEY", "\"5d68d29bb8d235e4b0dde6edac7e32d1\""
        }

        bangbangzu {
            resValue "string", "app_name", "51å‡­æ¡"
            applicationId 'com.receipt.px'
            manifestPlaceholders = [
                    package_name       : applicationId,
                    UMENG_CHANNEL_VALUE: "offline",
                    UMENG_APPKEY       : "5bf769e6b465f5c0800000d4",
                    JPUSH_PKGNAME      : applicationId,
                    JPUSH_APPKEY       : "9d89c242e309727940fbbf96",
                    JPUSH_CHANNEL      : "developer-default",
            ]
            buildConfigField "String", "UMENG_PUSH_SECRET", "\"1475d1586bd9c83606049ef0db4f2e4a\""
            buildConfigField "String", "ANDROID_BANNER_NID", "\"androidHomeBannerBangBangZu\""
            buildConfigField "Integer", "APP_ID", "102"
            buildConfigField "String", "APP_FLAG", "\"51PINGTIAO\""
            buildConfigField "String", "APP_NAME", "\"51å‡­æ¡\""
            buildConfigField "String", "QIYU_APPKEY", "\"5d68d29bb8d235e4b0dde6edac7e32d1\""
        }

        yijiebao {
            resValue "string", "app_name", "æ˜“å€Ÿå®"
            applicationId 'com.pdl.yjb'
            manifestPlaceholders = [
                    package_name       : applicationId,
                    UMENG_CHANNEL_VALUE: "offline",
                    UMENG_APPKEY       : "5bf769e6b465f5c0800000d4",
                    JPUSH_PKGNAME      : applicationId,
                    JPUSH_APPKEY       : "9d89c242e309727940fbbf96",
                    JPUSH_CHANNEL      : "developer-default",
            ]
            buildConfigField "String", "UMENG_PUSH_SECRET", "\"1475d1586bd9c83606049ef0db4f2e4a\""
            buildConfigField "String", "ANDROID_BANNER_NID", "\"androidHomeBanner1\""
            buildConfigField "Integer", "APP_ID", "1"
            buildConfigField "String", "APP_FLAG", "\"YJB\""
            buildConfigField "String", "APP_NAME", "\"æ˜“å€Ÿå®\""
            buildConfigField "String", "QIYU_APPKEY", "\"5d68d29bb8d235e4b0dde6edac7e32d1\""
        }
    }


    productFlavors.all { flavor ->
        flavor.manifestPlaceholders = [UMENG_CHANNEL_VALUE: name]
    }

    applicationVariants.all { variant ->
        variant.outputs.all { output ->
            def apkFileName = name + "_v${versionName}_${versionCode}_${buildTime()}_release.apk"
            def outFile = output.outputFile
            if (outFile != null && outFile.name.endsWith(".apk")
                    && 'release' == variant.buildType.name) {
                outputFileName = apkFileName
            }
        }
    }
}

static def buildTime() {
    def date = new Date()
    def formatDate = date.format('yyMMddhhmm')
    return formatDate
}

dependencies {
    implementation fileTree(include: ['*.jar'], dir: 'libs')
    implementation 'me.jessyan:arms:2.5.0'
    implementation 'me.jessyan:arms-imageloader-glide:2.5.0'

    //view
    implementation rootProject.ext.dependencies["autosize"]

    //dagger2
    implementation rootProject.ext.dependencies["dagger2"]
    annotationProcessor rootProject.ext.dependencies["dagger2-compiler"]

    //æ³¨æ„ Arms æ ¸å¿ƒåº“ç°åœ¨å¹¶ä¸ä¼šä¾èµ–æŸä¸ª EventBus, è¦æƒ³ä½¿ç”¨ EventBus, è¿˜è¯·åœ¨é¡¹ç›®ä¸­è‡ªè¡Œä¾èµ–å¯¹åº”çš„ EventBus

    //ç°åœ¨æ”¯æŒä¸¤ç§ EventBus, greenrobot çš„ EventBus å’Œç•…é”€ä¹¦ ã€ŠAndroidæºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹çš„ä½œè€… ä½•çº¢è¾‰ æ‰€ä½œçš„ AndroidEventBus

    //ä¾èµ–å Arms ä¼šè‡ªåŠ¨æ£€æµ‹æ‚¨ä¾èµ–çš„ EventBus å¹¶è‡ªåŠ¨æ³¨å†Œ

    //å»ºè®®ä½¿ç”¨ AndroidEventBus, ç‰¹åˆ«æ˜¯ç»„ä»¶åŒ–é¡¹ç›®, åŸå› è¯·çœ‹ https://github.com/hehonghui/AndroidEventBus/issues/49

    //è¿™ç§åšæ³•å¯ä»¥è®©ä½¿ç”¨è€…æœ‰è‡ªè¡Œé€‰æ‹©ä¸‰æ–¹åº“çš„æƒåˆ©, å¹¶ä¸”è¿˜å¯ä»¥å‡è½» Arms çš„ä½“ç§¯

    //    implementation rootProject.ext.dependencies["androideventbus"]

    //    implementation rootProject.ext.dependencies["eventbus"]

    //test
    debugImplementation rootProject.ext.dependencies["canary-debug"]
    releaseImplementation rootProject.ext.dependencies["canary-release"]
    testImplementation rootProject.ext.dependencies["canary-release"]
    testImplementation rootProject.ext.dependencies["junit"]
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version"

    //ä¾èµ–æ’ä»¶
    kapt rootProject.ext.dependencies["dagger2-compiler"]
    kapt rootProject.ext.dependencies["dagger2-android-processor"]

    //ğŸ”¥ a powerful & easy to use library for Android (https://github.com/Blankj/AndroidUtilCode)
    implementation rootProject.ext.dependencies["android-utils-code"]

    //greenrobot eventbus
    implementation rootProject.ext.dependencies["eventbus"]

    //picasso

    //    implementation rootProject.ext.dependencies["picasso"]

    //autolayout
    implementation rootProject.ext.dependencies["autolayout"]

    //okhttp3
    api rootProject.ext.dependencies["okhttp3"]

    //    //retrofit

    //    implementation rootProject.ext.dependencies["retrofit"]

    //    //retrofit-converter-gson

    //    implementation rootProject.ext.dependencies["retrofit-converter-gson"]

    //    //retrofit-adapter-rxjava

    //    implementation rootProject.ext.dependencies["retrofit-adapter-rxjava"]

    //    //retrofit-adapter-rxjava2

    //    implementation rootProject.ext.dependencies["retrofit-adapter-rxjava2"]

    //    //okhttp-urlconnection

    //    implementation rootProject.ext.dependencies["okhttp-urlconnection"]

    //    //glide

    //    implementation rootProject.ext.dependencies["glide"]

    //    //glide-compiler

    //    implementation rootProject.ext.dependencies["glide-compiler"]

    //    annotationProcessor rootProject.ext.dependencies["glide-compiler"]

    //    //glide-loader-okhttp3

    //    implementation rootProject.ext.dependencies["glide-loader-okhttp3"]

    //ä½¿ç”¨okhttpç½‘ç»œæ—¥å¿—æ‹¦æˆªå™¨
    implementation 'com.squareup.okhttp3:logging-interceptor:3.5.0'
    implementation rootProject.ext.dependencies["retrofit-url-manager"]
    implementation rootProject.ext.dependencies["progressmanager"]

    // å¼ºå¤§ã€å¯å®šåˆ¶ã€æ˜“æ‰©å±•çš„ ViewPager æŒ‡ç¤ºå™¨æ¡†æ¶ã€‚

    //https://github.com/hackware1993/MagicIndicator

    //    api 'com.github.hackware1993:MagicIndicatorHelp:1.5.0'

    //retrofitçš„logæ—¥å¿—

    //butterknife
    implementation rootProject.ext.dependencies["appcompat-v7"]
    kapt rootProject.ext.dependencies["butterknife-compiler"]

    //ä»¿iosåŠ è½½æ¡†
    implementation 'com.kaopiz:kprogresshud:1.2.0'

    //å¹¿å‘Šbanner
    implementation 'com.bigkoo:convenientbanner:2.0.5'

    //BRVAHæ˜¯ä¸€ä¸ªå¼ºå¤§çš„RecyclerAdapteræ¡†æ¶
    implementation 'com.github.CymChad:BaseRecyclerViewAdapterHelper:2.9.30'
    api 'com.makeramen:roundedimageview:2.3.0'
    api 'com.android.support:multidex:1.0.3'
    // ä½œä¸ºä¾èµ–é¡¹ç›®æ·»åŠ  æ­¤å¤„ä¸å†æ·»åŠ 
    // implementation 'cn.aigestudio.wheelpicker:WheelPicker:1.1.2'

    //aliyun  oss å›¾ç‰‡ä¸Šä¼ 
    implementation 'com.aliyun.dpa:oss-android-sdk:+'

    //ä¸€æ¬¾é’ˆå¯¹androidå¹³å°ä¸‹çš„å›¾ç‰‡é€‰æ‹©å™¨ï¼Œæ”¯æŒä»ç›¸å†Œæˆ–æ‹ç…§é€‰æ‹©å›¾ç‰‡æˆ–è§†é¢‘ã€éŸ³é¢‘ï¼Œæ”¯æŒåŠ¨æ€æƒé™è·å–ã€è£å‰ª(å•å›¾orå¤šå›¾è£å‰ª)ã€å‹ç¼©ã€ä¸»é¢˜è‡ªå®šä¹‰é…ç½®ç­‰åŠŸèƒ½ã€é€‚é…android 6.0+ç³»ç»Ÿçš„å¼€æºå›¾ç‰‡é€‰æ‹©æ¡†æ¶ã€‚
    implementation 'com.github.LuckSiege.PictureSelector:picture_library:v2.2.3'
    implementation 'com.bm.photoview:library:1.4.1'
    implementation 'com.tencent.mm.opensdk:wechat-sdk-android-with-mta:+'
    implementation 'com.google.code.findbugs:jsr305:3.0.2'

    //https://github.com/scwang90/SmartRefreshLayout
    implementation 'com.scwang.smartrefresh:SmartRefreshLayout:1.1.0-alpha-21'
    implementation 'com.meituan.android.walle:library:1.1.6'

    //Umengç»Ÿè®¡ç»„ä»¶
    implementation 'com.umeng.umsdk:analytics:8.0.2'
    implementation 'com.umeng.umsdk:common:2.0.2'

    //A beautiful, slim Android numberprogressbar.
    implementation 'com.daimajia.numberprogressbar:library:1.4@aar'
    //Jpushç›¸å…³
    implementation 'cn.jiguang.sdk:jpush:3.2.0'  // æ­¤å¤„ä»¥JPush 3.2.0 ç‰ˆæœ¬ä¸ºä¾‹ã€‚
    implementation 'cn.jiguang.sdk:jcore:1.2.7'  // æ­¤å¤„ä»¥JCore 1.2.7 ç‰ˆæœ¬ä¸ºä¾‹ã€‚

    //pdfåŠ è½½å™¨
    implementation 'com.github.barteksc:android-pdf-viewer:2.8.2'


    implementation project(':baselib')
    implementation project(':magicindicator')
    implementation project(':wheelpicker-master')
}

walle {
    // æŒ‡å®šæ¸ é“åŒ…çš„è¾“å‡ºè·¯å¾„
    apkOutputFolder = new File("${project.buildDir}/outputs/channels")
    // å®šåˆ¶æ¸ é“åŒ…çš„APKçš„æ–‡ä»¶åç§°
    apkFileNameFormat = "pingtiao51_"+'${channel}.apk'
    // æ¸ é“é…ç½®æ–‡ä»¶
    channelFile = new File("${project.getProjectDir()}/channel")
}
